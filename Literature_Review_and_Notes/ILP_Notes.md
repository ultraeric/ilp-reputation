# Interledger Protocol
## What is ILP?
A multi-hope streaming network protocol allowing for micropayments and interoperability between different ledgers.
ILP uses *conditional transfers* to secure payments across multiple hops and through untrusted connectors. Only local trust is required. Atomicity is obtained through two-phase commits.

### ILP Packets
#### Types of Packets
`prepare` : generated by sender and forwarded to the next connector until received by receiver; each packet has a *‌cryptographic condition (SHA-256) * and *‌timeout*. Transport layer protocols are used to generate the SHA-256 hashes.  
This packet contains the following: destination account, amount, condition, timeout, transport-layer data.

`reject` : any connector in between can respond with this packet in case of error, or the receiver can respond with this if they do not wish to accept the payment.

`fulfill` : receiver responds with this packet when they accept the payment; this packet contains a 32-byte pre-image for the hash contained in the `prepare` packet; it is the connectors' job to validate the fulfillment.

A `prepare` packet is considered fulfilled when a connector received and forwards an incoming `fulfill` packet before the timeout specified in the `prepare` packet.This fulfillment creates an obligation for the peer which sent the `prepare` packet to settle with the connector. 

For example:
If Alice sends Connector C1 a `prepare` packet which C1 forwards to Connector C2, and after some time C1 receives a `fulfill` packet from C2 and forwards this to Alice before the timeout specified in the original `prepare` packet, then Alice is obligated to settle with (disburse funds to) C1. 

Note that settlement can be based on trust or enforced through functionality on some settlement ledger, such as Ethereum. Failure to deliver the `fulfill` packet on time is the main risk that connectors face.

## STREAM
STREAM is a transport layer protocol.  
It allows for the following:  
- The sender and receiver use a shared secret to generate the payment condition (SHA-256 hash that is contained in the `prepare` packet)  
- Authenticate the ILP Packet  
- Encrypt the application data  
## ILPv4
This is the Interledger layer responsible for forwarding Interledger packets between the sender and receiver. It defines the address and packet formats for ILP packets.
## Ledger Layer
Responsible for *executing* the individual transfers that constitute an Interledger transaction. Used by connectors to communicate with one another; provides a facility for data transmission and money transmission for settlement purposes. Many different protocols can belong to this layer (both blockchain and centralized) as long as the protocol implements the functionality described here: https://interledger.org/rfcs/0017-ledger-requirements/.  
Which protocol is used is up to the involved parties to choose.  
Example Protocols:  
- 5BLP  
- Bitcoin  
- Ethereum  
- PayPal API  (with extensions)



